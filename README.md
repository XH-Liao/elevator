# elevator
電梯面板設計

功能說明
1. 面板 (16×16 LED Array)
    - 顯示目前所在樓層
    - 顯示目前上樓或下樓
    - 電梯未在移動則不顯示箭頭
2. 數字鍵
    - 選擇欲抵達樓層，並按數字鍵

原理
1. 16×16 LED Array：透過快速的clock觸發，產生視覺暫留，使每一column看起來像同時顯示。
2. 數字鍵：分為三個state，分別為「沒有按下」、「掃描按下的按鍵」、「持續按住按鍵」，並且透過狀態轉移的方式實作而成。而關鍵的部分「掃描按下的按鍵」則是善用FPGA的輸入key_c和輸出key_r完成掃描。
3. 電梯：因為電梯移動樓層時需要時間，所以欲模擬它就需要一個計時器。
    - 在倒數過程中，顯示器的左半部顯示箭頭（上或下），並且向上或下移動。
    - 在倒數結束後就移動一層樓（向上或向下）。
4. 除頻器
    - clk_LED（for 箭頭位移）：因為需要讓箭頭向上或向下移動，所以需要一個clock觸發使箭頭不斷的位移。
    - clk_sec（for 倒數移動樓層秒數）：為了讓箭頭完整移動後才移動一層樓，因此並非使用clk當作除頻基準，而是clk_LED。

方法
1. 鍵盤：在按下按鍵後儲存到reg number。
2. floor, nextFloor：reg floor儲存目前所在樓層，nextFloor儲存欲前往的樓層。當電梯並非在運作時（up, down二flag皆為0），才將number存入nextFloor。
3. up, down：當nextFloor>floor時，表示欲上樓，因此設up為1；當nextFloor<floor時，表示欲下樓，因此設down為1；而nextFloor==floor時，表示不移動，所以up, down皆設為0。
4. 移動樓層：使用clk_sec以及sec模擬一棟樓層的時間，當觸發clk_sec時就減一，直到為0時就移動一層樓。
5. 16×16 LED Array輸出：
    - 樓層（右半部）：根據floor輸出（使用case(floor) … endcase）。
    - 箭頭（左半部）：想將這部分做的較為美觀，如平日所見的電梯，具有一定的困難度。透過觀察電梯面板的影片數次之後，才想出這個實作方法。以上樓作為舉例，觀察電梯的影片之後，可以發現每個箭頭都是由下而上移動，那就代表箭頭前面有一塊空白，後方也有一塊空白。因此需要設reg [47:0] arrow_up1={16'b1111111111111111, 16'b1111111111110111, 16'b1111111111111111}（以arrow_up1作為舉例，尚有arrow_up2, …等），然後再透過reg n（儲存位移量），以及clk_LED（觸發就將n加一）指定欲輸出的部分（上樓為[n+:16]，代表從[0:15]\~[32:47]；下樓為[47-n-:16]，代表從[32:47]\~[0:15]），使箭頭能夠由下而上，完美的顯示。

